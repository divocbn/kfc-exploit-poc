
import { Suspense } from "react";

import FilterFoodCategory from "./_components/filter-food-category";
import Products from "./_components/products";

import { kfcGenericMenuApi } from "~/server/generic-menu.kfc-api";

export const dynamic = "force-dynamic";

export const metadata = {
  title: "Adresse"
};

type Props = {
  searchParams?: {
    category: string,
  };
};

export default async function HomePage({
  searchParams
}: Props) {
  const menu = await kfcGenericMenuApi.getGenericMenu();
  
  /**
   * This looks shit af
   * but the kfc api is kinda cursed, not my fault 🙏
   */
  let categories = menu.categories[0]?.categories.map((category) => category.name);
  
  // why are free & uptrade products in the generic menu??
  categories = categories?.filter(r => r !== "Gratis" && r !== "Uptrades");
  
  return (
    <div className="flex flex-col md:flex-row px-12">
      <div className="flex flex-col w-full max-w-fit mr-10">
        <FilterFoodCategory
          foodCategories={categories ?? ["null"]} />
      </div>

      <Suspense>
        <Products searchParams={searchParams} />
      </Suspense>
    </div>
  );
}
